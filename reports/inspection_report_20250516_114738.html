<!DOCTYPE html>
<html>
<head>
    
    <title>星相运维平台测试项目巡检报告</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-item .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        .stat-item .value {
            font-size: 1.2em;
            font-weight: bold;
        }
        .stat-item .value.alert {
            color: #dc3545;
        }
        .stat-item .value .critical {
            color: #dc3545;
            margin-right: 10px;
        }
        .stat-item .value .warning {
            color: #ffc107;
        }

         
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: auto;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            min-width: 100px;
        }

         
        th:first-child, td:first-child {
            min-width: 150px;
        }

         
        th:last-child, td:last-child {
            min-width: 180px;
        }

         
        th:nth-last-child(2), td:nth-last-child(2) {
            min-width: 80px;
        }

         
        th:nth-last-child(3), td:nth-last-child(3) {
            min-width: 100px;
        }

        th {
            background-color: #4CAF50;
            color: white;
        }

         
        tr.warning { 
            background-color: #fff3cd !important;
        }
        tr.normal { 
            background-color: #d4edda !important;
        }
        tr.critical { 
            background-color: #f8d7da !important;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .label-value {
            display: inline-block;
            background-color: #e9ecef;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            word-break: break-all;
            white-space: normal;
        }

        h1, h2, h3 {
            color: #333;
        }
        .section {
            margin-bottom: 30px;
        }
        .chart-container {
            height: 400px;
            margin-bottom: 30px;
        }

         
        @media screen and (max-width: 1200px) {
            .container {
                padding: 10px;
            }
            
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            
            td, th {
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <h1 style="text-align: center">星相运维平台测试项目巡检报告</h1>
        <p>生成时间: 2025-05-16 11:47:38</p>

        
        <div class="summary-cards">
            
            <div class="card 基础资源使用情况">
                <h3>基础资源使用情况</h3>
                <div class="stats">
                    <div class="stat-item">
                        <div class="label">最大值</div>
                        <div class="value">73.10</div>
                    </div>
                    <div class="stat-item">
                        <div class="label">最小值</div>
                        <div class="value">0.04</div>
                    </div>
                    
                    <div class="stat-item">
                        <div class="label">告警数</div>
                        <div class="value alert">
                            1/12
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="label">告警详情</div>
                        <div class="value">
                            <span class="critical">严重:0</span>
                            <span class="warning">警告:1</span>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>

        
        <div class="section">
            <h2>资源使用概览</h2>
            <div class="chart-container">
                <canvas id="resourceChart"></canvas>
            </div>
        </div>

        
        
        <div class="section">
            <h2>基础资源使用情况 监控指标</h2>
            
            <h3><li>/iflytek分区磁盘使用率</li></h3>
	    
             <p>未查询到数据</p>
            
            
            
            <h3><li>CPU使用率</li></h3>
	    
            
            <table>
                <tr>
                    <th>指标名称</th>
                    
                    
                        <th data-label-name="ident">节点名称</th>
                    
                    <th>值</th>
                    <th>状态</th>
                    <th>检测时间</th>
                </tr>
                
                <tr class="normal">
                    <td>CPU使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">241-ftp</span>
                                </td>
                            
                        
                    
                    <td>0.12%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>CPU使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">devops-app-169</span>
                                </td>
                            
                        
                    
                    <td>5.36%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>CPU使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">iflytek238</span>
                                </td>
                            
                        
                    
                    <td>0.04%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>CPU使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">iflytek239</span>
                                </td>
                            
                        
                    
                    <td>22.50%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>CPU使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">server176</span>
                                </td>
                            
                        
                    
                    <td>2.20%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>CPU使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">zjma6</span>
                                </td>
                            
                        
                    
                    <td>22.89%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
            </table>
            
            
            <h3><li>PVC使用率</li></h3>
	    
             <p>未查询到数据</p>
            
            
            
            <h3><li>Pod运行状态</li></h3>
	    
             <p>未查询到数据</p>
            
            
            
            <h3><li>内存使用率</li></h3>
	    
            
            <table>
                <tr>
                    <th>指标名称</th>
                    
                    
                        <th data-label-name="ident">节点名称</th>
                    
                    <th>值</th>
                    <th>状态</th>
                    <th>检测时间</th>
                </tr>
                
                <tr class="normal">
                    <td>内存使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">241-ftp</span>
                                </td>
                            
                        
                    
                    <td>10.32%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>内存使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">devops-app-169</span>
                                </td>
                            
                        
                    
                    <td>25.53%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>内存使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">iflytek238</span>
                                </td>
                            
                        
                    
                    <td>3.65%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>内存使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">iflytek239</span>
                                </td>
                            
                        
                    
                    <td>34.95%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="normal">
                    <td>内存使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">server176</span>
                                </td>
                            
                        
                    
                    <td>16.03%</td>
                    <td>
                        正常
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
                <tr class="warning">
                    <td>内存使用率</td>
                    
                        
                        
                            
                                <td data-label-name="ident">
                                    <span class="label-value">zjma6</span>
                                </td>
                            
                        
                    
                    <td>73.10%</td>
                    <td>
                        警告
                        
                    </td>
                    <td>2025-05-16 11:47:38</td>
                </tr>
                
            </table>
            
            
            <h3><li>大模型机器内存使用率</li></h3>
	    
             <p>未查询到数据</p>
            
            
            
            <h3><li>根分区磁盘使用率</li></h3>
	    
             <p>未查询到数据</p>
            
            
            
            <h3><li>节点就绪状态</li></h3>
	    
             <p>未查询到数据</p>
            
            
            
        </div>
        
    </div>

<script>
    
    function getRandomColor() {
        const hue = Math.random() * 360;
        return {
            background: `hsla(${hue}, 70%, 95%, 1)`,
            border: `hsla(${hue}, 70%, 70%, 1)`
        };
    }

    
    document.addEventListener('DOMContentLoaded', function() {
        const cards = document.querySelectorAll('.card');
        const cardCount = cards.length;
        
        
        const container = document.querySelector('.summary-cards');
        if (cardCount <= 2) {
            container.style.gridTemplateColumns = `repeat(${cardCount}, 1fr)`;
        } else if (cardCount <= 4) {
            container.style.gridTemplateColumns = 'repeat(2, 1fr)';
        }

        
        cards.forEach(card => {
            const colors = getRandomColor();
            card.style.backgroundColor = colors.background;
            card.style.borderLeft = `4px solid ${colors.border}`;
        });
    });

    
    const ctx = document.getElementById('resourceChart').getContext('2d');
    const data = {"基础资源使用情况":{"Type":"基础资源使用情况","MetricsByName":{"/iflytek分区磁盘使用率":[],"CPU使用率":[{"Instance":"","Name":"CPU使用率","Description":"节点CPU使用率统计","Value":0.11667637782590438,"Threshold":80,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.118953014+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"241-ftp"}]},{"Instance":"","Name":"CPU使用率","Description":"节点CPU使用率统计","Value":5.364338469979091,"Threshold":80,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.11895867+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"devops-app-169"}]},{"Instance":"","Name":"CPU使用率","Description":"节点CPU使用率统计","Value":0.03611010810770219,"Threshold":80,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.118963934+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"iflytek238"}]},{"Instance":"","Name":"CPU使用率","Description":"节点CPU使用率统计","Value":22.499347769526754,"Threshold":80,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.118969118+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"iflytek239"}]},{"Instance":"","Name":"CPU使用率","Description":"节点CPU使用率统计","Value":2.2014588397093307,"Threshold":80,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.118974006+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"server176"}]},{"Instance":"","Name":"CPU使用率","Description":"节点CPU使用率统计","Value":22.890625,"Threshold":80,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.118979023+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"zjma6"}]}],"PVC使用率":[],"Pod运行状态":[],"内存使用率":[{"Instance":"","Name":"内存使用率","Description":"节点内存使用率统计","Value":10.317300564458423,"Threshold":85,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.119838103+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"241-ftp"}]},{"Instance":"","Name":"内存使用率","Description":"节点内存使用率统计","Value":25.529907842772275,"Threshold":85,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.119844083+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"devops-app-169"}]},{"Instance":"","Name":"内存使用率","Description":"节点内存使用率统计","Value":3.650946113489615,"Threshold":85,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.119849568+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"iflytek238"}]},{"Instance":"","Name":"内存使用率","Description":"节点内存使用率统计","Value":34.953320467874796,"Threshold":85,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.11985482+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"iflytek239"}]},{"Instance":"","Name":"内存使用率","Description":"节点内存使用率统计","Value":16.033926127182188,"Threshold":85,"Unit":"%","Status":"normal","StatusText":"正常","Timestamp":"2025-05-16T11:47:38.119859894+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"server176"}]},{"Instance":"","Name":"内存使用率","Description":"节点内存使用率统计","Value":73.09985650706679,"Threshold":85,"Unit":"%","Status":"warning","StatusText":"警告","Timestamp":"2025-05-16T11:47:38.119865087+08:00","Labels":[{"Name":"ident","Alias":"节点名称","Value":"zjma6"}]}],"大模型机器内存使用率":[],"根分区磁盘使用率":[],"节点就绪状态":[]},"Stats":{"MaxValue":73.09985650706679,"MinValue":0.03611010810770219,"Average":0,"AlertCount":1,"CriticalCount":0,"WarningCount":1,"TotalCount":12}}}
    const labels = []; 
    const datasets = [];

    
    function getMetricValues(metricName, filterFn = null) {
        const values = [];
        const labels = new Set(); 
        
        for (const [type, group] of Object.entries(data)) {
            if (group.MetricsByName && group.MetricsByName[metricName]) {
                for (const metric of group.MetricsByName[metricName]) {
                    if (filterFn && !filterFn(metric)) continue;
                    
                    
                    const instanceLabel = metric.Labels.find(label => 
                        label.Name === "instance" || label.Name === "node"
                    );
                    if (instanceLabel) {
                        labels.add(instanceLabel.Value.split(':')[0]);
                        values.push(parseFloat(metric.Value));
                    }
                }
            }
        }
        return { values, labels: Array.from(labels) };
    }

    
    const cpuData = getMetricValues('CPU使用率');
    const memoryData = getMetricValues('内存使用率');
    const diskData = getMetricValues('磁盘使用率', (metric) => {
        return metric.Labels.some(label => 
            label.Value === "rootfs" || label.Value === "/"
        );
    });

    
    const chartLabels = cpuData.labels;
    
    function getColorByValue(value) {
        if (value >= 90) return '#dc3545';  
        if (value >= 80) return '#ffc107';  
        return '#4CAF50';                   
    }
    
    const chartDatasets = [
        {
            label: 'CPU使用率',
            data: cpuData.values,
            backgroundColor: cpuData.values.map(value => getColorByValue(value)),
        },
        {
            label: '内存使用率',
            data: memoryData.values,
            backgroundColor: memoryData.values.map(value => getColorByValue(value)),
        },
        {
            label: '磁盘使用率',
            data: diskData.values,
            backgroundColor: diskData.values.map(value => getColorByValue(value)),
        }
    ];

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: chartLabels,
            datasets: chartDatasets, 
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: '资源使用情况'
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                }
            }
        }
    });
</script>
</body>
</html>